<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dishcovery | 레시피 등록</title>
  <link rel="stylesheet" th:href="@{/css/register.css}">
  <link rel="stylesheet" th:href="@{/css/mainPage.css}" />
</head>
<body>
<header class="topbar">
  <div th:insert="fragments/header :: site-header"></div>

</header>

<main class="page">

  <section class="form-section container">
    <form class="recipe-form" th:object="${recipe}" method="get" enctype="multipart/form-data">
      <input type="hidden" name="recipeId" th:value="${recipe.recipeId}">
      <div class="form-card">
        <h2>기본 정보</h2>
        <div class="form-grid">
          <div class="form-row">
            <label for="title">레시피 이름</label>
            <input type="text" id="title" name="title" th:value="${recipe.title}" readonly="readonly">
          </div>
          <div class="form-row">
              <label for="categoryId">카테고리</label>
              <select id="categoryId" name="categoryId" disabled>
                  <option value="">선택</option>
                  <option th:each="cat : ${categoryList}" th:value="${cat.code}" th:text="${cat.codeName}" th:selected="${cat.code == recipe.categoryId}"></option>
              </select>
          </div>
          <div class="form-row">
            <label for="cookTime">조리 시간</label>
            <input type="text" id="cookTime" name="cookTime"   th:value="${recipe.cookTime}">
          </div>
          <div class="form-row">
            <label for="cookDfct">난이도</label>
            <select id="cookDfct" name="cookDfct" required>
              <option value="" disabled selected>선택하세요</option>
              <option th:each="lv : ${levelList}" th:value="${lv.code}" th:text="${lv.codeName}" th:selected="${lv.code == recipe.cookDfct}"></option>
            </select>
          </div>
        </div>
      </div>

        <div class="form-card">
            <div class="form-row">
                <h2>대표 이미지</h2>
                <div id="mainPreviewArea" class="single-preview-area">
                    <span>
                         <img th:src="${recipe.imgUrl}" alt="레시피 이미지" class="single-preview-image">
                    </span>
                </div>
            </div>
        </div>
      <div class="form-card">
        <h2>요리 소개와 준비물</h2>
        <div class="form-row">
            <label for="rcpDisc">요리 소개</label>

            <textarea id="rcpDisc" name="rcpDisc" rows="3" th:text="${recipe.rcpDisc}"    readonly> </textarea>

        </div>
        <div class="form-row">
          <label for="recipeIngr">필수 재료</label>
          <textarea id="recipeIngr" name="recipeIngr" rows="3" th:text="${recipe.recipeIngr}"   readonly></textarea>
        </div>
      </div>

      <div class="form-card">
        <div class="label-with-action">
            <h2>조리 단계</h2>
            <div class="listen-container">
                <button type="button" class="ghost-btn" data-add-step>단계 추가</button>
                <button type="button" class="ghost-btn" onclick="startStepTTS()">🔊 읽기</button>
                <button type="button" class="ghost-btn" onclick="stopStepTTS()">⏹ 중단</button>
            </div>
        </div>
        <p class="card-hint">각 단계마다 자세히 작성하면 노출 확률이 높아져요.</p>
        <div class="step-list" data-step-list>
            <div class="step-row" data-step  th:each="step : ${stepList}">
                <span class="step-index">1</span>
                <textarea id="stepDescriptions" name="stepDescriptions" rows="2" th:text="${step.stepDescription}" readonly></textarea>
                <input type="hidden" id="stepOrder" name ="stepOrder" th:value="${step.stepOrder}">
                <button type="button" class="step-remove" data-remove-step aria-label="1단계 삭제">&times;</button>
            </div>
        </div>
      </div>
      <div class="form-card">
        <h2>마무리</h2>
        <div class="form-row">
            <label for="recipeTip">팁 &amp; 노하우</label>
            <textarea id="recipeTip" name="recipeTip" rows="2"  th:text="${recipe.recipeTip}"   readonly></textarea>
        </div>
        <div class="form-row">
            <label for="recipeTag">해시태그</label>
            <input type="text" id="recipeTag" name="recipeTag" th:value="${recipe.recipeTag}"   readonly>
        </div>
      </div>

    </form>
  </section>
</main>

    <div class="toast" role="status" aria-live="polite" hidden>레시피 등록 요청이 전송되었습니다.</div>

    <script th:src="@{/js/register.js}"></script>
    <script th:src="@{/js/step-tts.js}"></script>

</body>
</html>